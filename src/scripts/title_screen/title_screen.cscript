#include "../../raptiquax.h"
#include "../../math/math_util.h"
#include "../../storage/node.h"
#include "../../render/camera.h"
#include "../../gui/frame.h"
#include "../../storage/queue.h"
#include "../../utils/scene.h"
#include "../../io/audio.h"
#include "../../render/lighting.h"
#include "../../buffer.h"
#include "../../window.h"


NEW_SCRIPT(title_screen_init)
	play_music("assets/audio/musics/Menu (launch) theme 2.mp3", MIX_MAX_VOLUME, -1);
END_SCRIPT(title_screen_init)

NEW_SCRIPT(title_screen_camera)
	GET_READY_PARAMETERS();

	window.fadeColor[3] *= 0.99f;
	this->rot[1] += 1.0f;
	const float distance = 25.0f;
	glm_vec3_copy((vec3) {sin(to_radians(this->rot[1]))*distance, 5.0f, cos(to_radians(this->rot[1]))*distance}, this->pos);

END_SCRIPT(title_screen_camera)


NEW_SCRIPT(play_game_button)
	GET_SIGNAL();	
	switch (signal) {
		case SIGNAL_BUTTON_CLICKED:
			play_sfx("assets/audio/sfx/button-clicked-sfx.mp3", 50, 0);
			window.fadeColor[3] = 0.0f;
			if (input.active_keys & KEY_SHIFT) {
				prepare_change_scene("assets/scenes/fps_chess/fpschess.scene");
			} else {
				prepare_change_scene("assets/scenes/claude_chappe/whole_scene.scene");
			}
			break;
		case SIGNAL_BUTTON_HOVERED:
			play_sfx("assets/audio/sfx/button-hover-sfx.mp3", 50, 0);
			break;
		default:
			break;
	}
END_SCRIPT(play_game_button)


NEW_SCRIPT(settings_game_button)
	GET_SIGNAL();	
	switch (signal) {
		case SIGNAL_BUTTON_CLICKED:
			play_sfx("assets/audio/sfx/button-clicked-sfx.mp3", 50, 0);
			window.fadeColor[3] = 0.0f;
			prepare_change_scene("assets/scenes/settings/main.scene");
			break;
		case SIGNAL_BUTTON_HOVERED:
			play_sfx("assets/audio/sfx/button-hover-sfx.mp3", 50, 0);
			break;
		default:
			break;
	}
END_SCRIPT(settings_game_button)


NEW_SCRIPT(quit_game_button)
	GET_SIGNAL();	
	switch (signal) {
		case SIGNAL_BUTTON_CLICKED:
			play_sfx("assets/audio/sfx/button-clicked-sfx.mp3", 50, 0);
			queue_push(&callQueue, NULL);
			break;
		case SIGNAL_BUTTON_HOVERED:
			play_sfx("assets/audio/sfx/button-hover-sfx.mp3", 50, 0);
			break;
		default:
			break;
	}
END_SCRIPT(quit_game_button)